New York - US President Donald Trump's former personal lawyer Michael Cohen testified on Tuesday that Trump had directed him to commit a crime by arranging payments ahead of the 2016 presidential election to silence two women who claimed to have had affairs with Trump. Cohen, 51, made the statements as he pleaded guilty to eight criminal charges in federal court in Manhattan, including tax evasion, bank fraud and campaign finance violations. Cohen did not name Trump in court, but his lawyer, Lanny Davis, said afterward that he was referring to the president. "Today he (Cohen) stood up and testified under oath that Donald Trump directed him to commit a crime by making payments to two women for the principal purpose of influencing an election," Davis said in a statement. "If those payments were a crime for Michael Cohen, then why wouldn't they be a crime for Donald Trump?" Davis said. The two payments were intended to silence two women who claimed to have had affairs with Trump and were made prior to the 2016 presidential election. One was for $130 000 given to adult-film star Stormy Daniels. The other for $150 000 related to former Playboy model Karen McDougal. Trump has denied having affairs with the women. His lawyer Rudy Giuliani has said the payments were made to spare Trump and his family embarrassment and were unrelated to the campaign. Trump did not mention Cohen at a rally in West Virginia hours after his former attorney accused him of violating campaign finance laws. Giuliani lashed out at Cohen on Tuesday, calling him a "devious little rat" and saying he has a history of lying. "I think the president is absolutely in the clear," Giuliani told Reuters. "The Cohen thing is over." Cohen, who was one of Trump's closest associates for more than a decade, said in court that he arranged to make payments "for (the) principal purpose of influencing (the) election" at the direction of a candidate for federal office. Robert Khuzami, a prosecutor for the Manhattan US Attorney's Office, said of Cohen: “He worked to pay money to silence two women who had information that he believed would be detrimental to the 2016 campaign and to the candidate.” Khuzami told reporters that Cohen sought reimbursement for the money by submitting “sham” invoices for legal services to the candidate’s company.  The guilty pleas came in the same hour that a federal jury in Alexandria, Virginia, convicted former Trump campaign chairman Paul Manafort of eight charges of tax and bank fraud and failing to disclose foreign bank accounts. The Manafort conviction resulted from US Special Counsel Robert Mueller's investigation into Russian meddling in the 2016 US election and possible coordination with the Trump campaign. The probe also led to a referral from Mueller about Cohen to federal prosecutors in New York who began their own probe of the longtime Trump lawyer. Trump has repeatedly denied any collusion and has called the Mueller investigation a "witch hunt." Russia has denied meddling in the election, though US intelligence agencies have concluded Moscow interfered. Mueller has also brought indictments against 12 Russian intelligence officers in the hacking of Democratic National Committee emails. Cohen's plea deal includes a possible sentence of up to five years and three months in prison, Judge William Pauley III said during the hearing. Pauley scheduled sentencing for December 12 and set bail at $500 000. Cohen, who worked as Trump's personal attorney at the Trump Organization, continued to advise the president after the election, but their relationship has frayed in recent months. Mueller's investigation, which began in May 2017, has resulted in the indictment of more than 30 people and five guilty pleas. Reuters