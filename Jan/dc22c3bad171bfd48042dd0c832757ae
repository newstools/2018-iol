Kabul - Gunmen stormed a luxury hotel in Kabul and killed at least six people including a foreigner, sparking a 12-hour fight with security forces that left terrified guests scrambling to escape and parts of the building ablaze. People trapped at the top of the six-storey Intercontinental Hotel, on a hilltop overlooking the Afghan capital, could be seen tying together bedsheets and climbing over balconies to escape the overnight siege. One lost his grip and fell in dramatic television footage by Afghanistan's Tolo News station, which also showed black smoke and flames billowing from the top of the hotel. During the night special forces were lowered by helicopters onto the roof of the landmark 1960s building, with Afghan security forces killing four attackers in the hours-long assault, the interior ministry said. "Five Afghans and one foreigner have been killed," interior ministry deputy spokesman Nasrat Rahimi told AFP Sunday, adding around 150 people were rescued including more than 40 foreigners. "The body of the foreigner, a woman, was recovered from the sixth floor as the last attacker was being killed," he added. An official with Afghanistan's spy agency put the number of wounded at eight, while the interior ministry said six. Officials said four gunmen burst into the hotel, which is not part of the global InterContinental chain, on Saturday night, opening fire on guests and staff and taking dozens of people hostage. While there was no immediate claim of responsibility for the latest assault in the war-torn Afghan capital, the interior ministry issued a statement blaming the Taliban-affiliated Haqqani network. It followed a series of security warnings in recent days to avoid hotels and other locations frequented by foreigners in the city. In recent months Kabul has become one of the deadliest places in Afghanistan for civilians, with the Taliban and the Islamic State group both stepping up attacks. It was not clear how many people had been inside the hotel, which was attacked by Taliban militants in 2011. During the siege, a guest hiding in a room said he could hear gunfire inside the building, where dozens of people attending an information technology conference on Sunday were staying. "I don't know if the attackers are inside the hotel but I can hear gunfire from somewhere near the first floor," the man, who did not want to be named, told AFP by telephone. "We are hiding in our rooms. I beg the security forces to rescue us as soon as possible before they reach and kill us." His phone has been switched off since speaking to AFP. - 'Fleeing like crazy' - Afghan Telecom regional director Aziz Tayeb, who was attending the IT conference, said he saw the attackers enter the hotel as he was walking towards the exit. "Everything became chaotic in a moment. I hid behind a pillar and I saw people who were enjoying themselves a second ago screaming and fleeing like crazy, and some of them falling down, hit by bullets," Tayeb told AFP. Local resident Abdul Sattar said he had spoken by phone to some of his friends who are chefs and waiters at the hotel and had been trapped inside. "Suddenly they attacked the dinner gathering... (then) they broke into the rooms, took some people hostage and they opened fire on some of them," he told AFP. Rahimi said the attackers were armed with light weapons and rocket-propelled grenades when they stormed the hotel, a popular venue for weddings, conferences and political gatherings. Security in Kabul has been ramped up since May 31 when a massive truck bomb ripped through the diplomatic quarter, killing some 150 people and wounding around 400 others -- mostly civilians. - Devastating attacks - But the resurgent Taliban and  Islamic State are both scaling up their assaults on the city, with multiple devastating attacks in recent weeks, including an IS-claimed suicide blast targeting Shiites last month which killed more than 40 people. The last major attack on a high-end hotel in Kabul was in March 2014 when four teenage gunmen raided the Serena, killing nine people including AFP journalist Sardar Ahmad. The Intercontinental was previously targeted in June 2011 when a suicide attack claimed by the Taliban killed 21 people including 10 civilians. Security at the Intercontinental is relatively lax compared with other luxury hotels in Kabul. Even before the attack was over, authorities were questioning how the attackers got past the hotel's security, which was taken over by a private company three weeks ago, said Najib Danish, another interior ministry spokesman. "We will investigate it," he said. A hotel employee told AFP that as he fled the staff living quarters in a building next to the hotel he saw the new security guards running for their lives. "They didn't do anything, they didn't attack. They had no experience," the man said on  condition of anonymity. AFP